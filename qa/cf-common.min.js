!function(){try{let i={init:()=>{i.getOrderForm(),i.bringCategories(),i.toggleMenuMobile(),i.handleNewsLetterForm()},ajaxStop:()=>{},data:{categories:null},regex:{domain:/\/https:\/\/casaflora.vtexcommercestable.com.br/g},getOrderForm:()=>{vtexjs.checkout.getOrderForm().done(function(e){i.totalItemsOrderForm(e)})},bringCategories:()=>{$.ajax({type:"GET",url:"/api/catalog_system/pub/category/tree/3/",dataType:"json",contentType:"application/json",headers:{"Content-Type":"application/json",Accept:"application/vnd.vtex.ds.v10+json"}}).done(function(e){i.data.categories=e,i.buildList(),i.seeAllButtonMenu(),$(window).width()<=991?(i.checkIfElementHasAKid(),i.toggleActiveSubmenus()):i.fillMenuWithImages()})},buildList:()=>{let e=i.data.categories,a=$(".cf-header__menu.list"),s="",n=/https:\/\/casaflora.vtexcommercestable.com.br/g;e.map(e=>{let a=i.buildFirstSubList(e),t="";$(a).length&&(t=a);e=`\n                            <li class="mainli">\n                                <a class="main-link" href=${e.url.replace(n,"")}>${e.name}</a>\n                                ${t}\n                            </li>\n                        `;s+=e}),a.html(s)},buildFirstSubList:e=>{if(e.hasChildren){let s="",n=/https:\/\/casaflora.vtexcommercestable.com.br/g;return(e.children.map(e=>{let a=i.buildSecondSubList(e),t="";$(a).length&&(t=a);e=`<li class="sublink-first"><a href="${e.url.replace(n,"")}">${e.name}</a>${t}</li>`;s+=e}),991<=$(window).width())?`<div class="menu-dropdown"><ul class="sublist-first">${s}</ul></div>`:`<ul class="sublist-first">${s}</ul>`}},buildSecondSubList:n=>{if(n.hasChildren){let a="",t=/https:\/\/casaflora.vtexcommercestable.com.br/g,s=1;n.children.map(e=>{s<=8&&(n.name!==e.name&&(e=`<li class="sublink-second"><a href="${e.url.replace(t,"")}">${e.name}</a></li>`,a+=e),s++)});var e=`<ul class="sublist-second">${a}</ul>`;if('<ul class="sublist-second"></ul>'!=e)return e}},checkIfElementHasAKid:()=>{$(".main-link").find("+ ul").prev().addClass("hasUl").wrap('<div class="dropdown-wrapper"></div>').parent().append('<i class="icon-arrow">'),$(".sublink-first:not(hasUl) > ul").parent().addClass("hasUl").find("> a").wrap('<div class="dropdown-wrapper"></div>').parent().append('<i class="icon-arrow">')},toggleActiveSubmenus:()=>{$(".cf-header__menu.list").find("ul").slideUp(),$(".icon-arrow").on("click",function(){$(this).parent().parent().is(":not(.active)")?$(this).parent().parent().addClass("active").find(" > ul").slideDown("slow"):$(this).parent().parent().removeClass("active").find(" > ul").slideUp("slow")})},toggleMenuMobile:()=>{$(".header__menu-icon").on("click",function(){$(".cf-header__list-mobile").addClass("active"),$("body").addClass("overflowed")}),$(".cf-header__list-mobileClose").on("click",function(){$(".cf-header__list-mobile").removeClass("active"),$("body").removeClass("overflowed")})},fillMenuWithImages:()=>{$('.cf-header.desktop .main-link[href="/alimentos"] + .menu-dropdown').append('<div class="banner-menu"><a href="https://casaflora.vtexcommercestable.com.br/alimentos/massa?PS=12"><img src="https://casaflora.vteximg.com.br/arquivos/alimentos01.png"/></a></div>'),$('.cf-header.desktop .main-link[href="/bebidas"] + .menu-dropdown').append('<div class="banner-menu"><a href="https://casaflora.vtexcommercestable.com.br/460025_gin_apogee/p"><img src="https://casaflora.vteximg.com.br/arquivos/destilados.png"/></a></div>'),$('.cf-header.desktop .main-link[href="/vinhos"] + .menu-dropdown').append('<div class="banner-menu"><a href="https://casaflora.vtexcommercestable.com.br/612067_v__esp_pescador_bc/p"><img src="https://casaflora.vteximg.com.br/arquivos/promo.jpg"/><a href="/vinhos/frances"><img src="https://casaflora.vteximg.com.br/arquivos/outlet02.png"/></a></a></div>')},totalItemsOrderForm:t=>{if(t.items.length){let e=$(".button__minicart-qty"),a=0;t.items.forEach(e=>{a+=e.quantity}),e.text(a)}},seeAllButtonMenu:()=>{$('.main-link:not([href="/alimentos"])').next().find(".sublist-second").each(function(){var e=$(this).prev("a").attr("href");0!==$(this).has("li").length&&(e=`<li class="sublink-second">\n                <a class="verTodos" href="${e}">\n                  <strong>Ver todos</strong>\n                </a>\n              </li>\n              `,$(this).append(e))})},handleNewsLetterForm:()=>{var t=document.querySelector("#newsletter-form");t.addEventListener("submit",function(e){e.preventDefault();var e=e.target.querySelectorAll("input[name]"),a={};e.forEach(function(e){a[e.name]=e.value}),i.sendForm(a).done(function(e){t.reset(),$("input").val(""),alert("Formulario enviado com sucesso!")})},!1)},sendForm:function(e){e={type:"PATCH",url:"/api/dataentities/NL/documents",dataType:"json",headers:{Accept:"application/vnd.vtex.ds.v10+json","Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(e)};return $.ajax(e)}};$(document).ready(i.init),$(document).ajaxStop(i.ajaxStop)}catch(e){console.log("Erro na inst√¢ncia do [Common]: ",e)}}();