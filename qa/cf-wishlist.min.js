!function(){try{let a={init:function(){a.getInfo(),$(document.body).is(".product")&&(a.addProdutcInList(),a.removeProductInList()),a.addShelfProductInList(),a.removeShelfProductInList()},dataUserOrderForm:null,dataUserParsed:null,getInfo:()=>{var e;localStorage&&localStorage.CF_listUser&&localStorage.CF_listUser.length?(e=JSON.parse(localStorage.CF_listUser),null==(a.dataUserParsed=e).useritems?a.emptyListInUserPage():e.useritems.length&&($(document.body).is(".product")&&a.setDataInFrontProduct(),$(document.body).is(".wishlist")&&a.showProductsInFavorites(),a.showProductInShowAlreadyAdd(),$(".shelf-item__wishlist button").removeClass("list-loaded"))):vtexjs.checkout.getOrderForm().done(function(e){e.clientProfileData&&null!=e.clientProfileData.email?a.getInfoByOrderForm(e):$(".shelf-item__wishlist button").removeClass("list-loaded")})},getInfoByOrderForm:t=>{var e=t.clientProfileData.email;$.ajax({type:"GET",url:`/api/dataentities/favoritos/search?_schema=cf-body&email=${e}`,dataType:"json",contentType:"application/json",headers:{Accept:"application/vnd.vtex.ds.v10+json","Content-Type":"application/json; charset=utf-8"}}).done(function(e){e.length?(console.log("Usuario com lista"),localStorage.setItem("CF_listUser",JSON.stringify(e[0])),a.dataUserParsed=e[0],$(document.body).is(".product")&&a.setDataInFrontProduct(),$(document.body).is(".wishlist")&&a.showProductsInFavorites(),a.showProductInShowAlreadyAdd(),$(".shelf-item__wishlist button").removeClass("list-loaded")):(console.log("Primeira vez no wishlist."),a.registerEmailInMDFirstTime(t))})},registerEmailInMDFirstTime:e=>{let t={email:e.clientProfileData.email,useritems:[]};console.log(t),$.ajax({type:"POST",url:"/api/dataentities/favoritos/documents?_schema=cf-body",dataType:"json",contentType:"application/json",headers:{Accept:"application/vnd.vtex.ds.v10+json","Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(t)}).done(function(e){t.id=e.DocumentId,localStorage.setItem("CF_listUser",JSON.stringify(t))})},setDataInFrontProduct:()=>{let t=!1;a.dataUserParsed.useritems.forEach(e=>{e==skuJson.productId&&(t=!0)}),t&&($(".cf-product-wishlist--button.add").addClass("hide"),$(".cf-product-wishlist--button.remove").removeClass("hide"))},showProductsInFavorites:()=>{let t=$(".wishlist-products--wrapper"),o=null;a.dataUserParsed.useritems.forEach((e,t,s)=>{o=0==t?`fq=productId:${e}`:`${o}&fq=productId:${e}`});var e=`/buscapagina?${o}&PS=50&sl=ff2a9142-b3a3-4bb4-94ed-02884096891f&cc=1&sm=0`;$.ajax({type:"GET",url:e}).done(function(e){t.append(e),a.removeShelfProductInListUser(),$(".wishlist-products--loader").hide()})},showProductInShowAlreadyAdd:function(){$(".shelf-item__wishlist.shelf-default").each(function(){let e=$(this),t=e.closest(".cf-storefront.main").attr("data-sku");console.log(t);var s=a.dataUserParsed.useritems.find(function(e){return e==t});console.log(s),s&&(e.find(".shelf-wishlist--button.shelf.add").addClass("hide"),e.find(".shelf-wishlist--button.shelf.remove").removeClass("hide"))})},addProdutcInList:function(){$(document).one("click",".cf-product-wishlist--button.add",function(e){a.verifyIfUserIsNull();let t=a.dataUserParsed.useritems;null==t?t=[skuJson.productId]:t.push(skuJson.productId);var s={id:a.dataUserParsed.id,email:a.dataUserParsed.email,useritems:t};a.sendPatchToMD(s)})},addShelfProductInList:function(){$(document).one("click",".shelf-wishlist--button.shelf.add",function(e){a.verifyIfUserIsNull();var t=$(this).closest(".cf-storefront.main").attr("data-sku"),t=parseInt(t);let s=a.dataUserParsed.useritems;null==s?s=[t]:s.push(t);t={id:a.dataUserParsed.id,email:a.dataUserParsed.email,useritems:s};a.sendPatchToMD(t)})},removeProductInList:function(){$(document).one("click",".cf-product-wishlist--button.remove",function(e){let t=a.dataUserParsed.useritems.filter(function(e){return e!==skuJson.productId});t.length||(t=[]);var s={id:a.dataUserParsed.id,email:a.dataUserParsed.email,useritems:t};a.sendPatchToMD(s)})},removeShelfProductInList:function(){$(document).one("click",".shelf-wishlist--button.shelf.remove",function(e){let t=$(this).closest(".cf-storefront.main").attr("data-sku");t=parseInt(t);let s=a.dataUserParsed.useritems.filter(function(e){return e!==t});s.length||(s=[]);var o={id:a.dataUserParsed.id,email:a.dataUserParsed.email,useritems:s};a.sendPatchToMD(o)})},removeShelfProductInListUser:()=>{$(document).one("click",".shelf-wishlist--button.shelf-button--remove.shelf-user",function(e){let t=$(this).closest(".cf-storefront.main").attr("data-sku");t=parseInt(t);let s=a.dataUserParsed.useritems.filter(function(e){return e!==t});s.length||(s=null);var o={id:a.dataUserParsed.id,email:a.dataUserParsed.email,useritems:s};a.sendPatchToMD(o)})},verifyIfUserIsNull:()=>{if(null==a.dataUserParsed)return vtexid.start(),void a.verifyVtexId()},emptyListInUserPage:()=>{$(".shelf-item__wishlist button").removeClass("list-loaded"),$(document.body).is(".wishlist")&&($(".wishlist-products--loader").addClass("hide"),$(".wishlist-products--empty").removeClass("hide"))},sendPatchToMD:t=>{var e=a.dataUserParsed.id;$.ajax({type:"PATCH",url:`/api/dataentities/favoritos/documents/${e}?_schema=cf-body`,dataType:"json",contentType:"application/json",headers:{"Content-Type":"application/json",Accept:"application/vnd.vtex.ds.v10+json"},data:JSON.stringify(t)}).done(function(e){localStorage.setItem("CF_listUser",JSON.stringify(t)),swal({title:"Lista de desejos atualizada!",icon:"success"}).then(()=>{location.reload()})})},reloadClickFunctionsIfCloseModal:function(){$("#dtbot-script").siblings("#vtexIdContainer.ng-scope").find(".vtexIdUI-page.ng-scope.vtexIdUI-confirm-email .close.vtexIdUI-close, .vtexIdUI-page.ng-scope.vtexIdUI-page-active .close.vtexIdUI-close, .vtexIdUI-page.ng-scope.vtexIdUI-no-permission .close.vtexIdUI-close, .vtexIdUI-page.ng-scope.vtexIdUI-multiple-link-account .close.vtexIdUI-close, .vtexIdUI-page.ng-scope.vtexIdUI-change-pswd .close.vtexIdUI-close").on("click",function(){a.addProdutcInList(),a.removeProductInList(),a.addShelfProductInList(),a.removeShelfProductInList()})},verifyVtexId:function(){let e=setInterval(function(){$("#vtexIdContainer.ng-scope").length&&(clearInterval(e),a.reloadClickFunctionsIfCloseModal())},50)}};$(document).ready(a.init)}catch(e){console.log("Erro na inst√¢ncia do [Wishlist]: ",e)}}();